# Wordlists 

Pre-built wordlists:
- these can be found in the `/usr/share/wordlists` directory in Kali

<br>

Custom wordlists:
- these a much more effective in a dictionary-based password attack as they are tailored to a target and a smaller, thus are more efficient than using a large pre-built wordlist 
- you should use passwords/credentials found during enumeration, or when exploiting other machines, to create custom wordlists 
	- i.e. if you found "Nanobot93" you can surmise that passwords for this target require at least two numbers to be used and, perhaps, passwords must end in a two digit integer
- **cewl** can be used to scrape a website and add words to a custom wordlist file 
- basic usage:`cewl <website> -m <mininuim_char_length> -w <wordlist>`
- i.e. `cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt`
- to make this wordlist include passwords which fit the likely password policy you can use **John the Ripper** (JtR) and apply it's rule mutations to the wordlist
- to do this you need to edit the `/etc/john/john.conf` file and append any new rules you want to add to the `[List.Rules:Wordlist]` section  
- i.e. to add two number to the end of each password include: `$[0-9]$[0-9]` 
- see [John rules](http://www.openwall.com/john/doc/RULES.shtml) for documentation on John's rule syntax 
- once you have added rules to the configuration file, you can mutate the wordlist by invoking John with specified dictionary file (`megacorp-cewl.txt`), activating the rules in the configuration file (`--rules`), and redirecting the output to new file (`mutated.txt`)
	- i.e. `john --wordlists=megacorp-cewl.txt --rules --stdout > mutated.txt`
- now, you can use this custom wordlist in a dictionary-based password attack
- example:
	- a) you find a common password pattern `ThisIsTheUsersPassword01`
	- b) you edit `/etc/john/john.conf` file and add the only rule `$[0-9]$[0-9]` to the `[List.Rules:Wordlist]` section
	- c) then you add `ThisIsTheUsersPassword` to a file called `word.txt` and run `john --wordlists=word.txt --rules --stdout > wordlist.txt`
	- d) use CrackMapExec to brute force domain users SMB login credentials with `crackmapexec smb targets.txt -u users.txt -p ad_wordlist.txt` (`targets.txt` contains a list of IPs running SMB)
	- e) finally, use impacket's smbexec.py script to get a SYSTEM shell on this system using found credentials `python3 /opt/impacket/examples/smbexec.py adam:ThisIsTheUsersPassword20@10.11.1.21`

<br>

Brute force wordlists:
- if you know the password policy of the target, you can create a brute force wordlist (a dictionary file containing every possible password that matches the specified pattern)
- to do this you can use **crunch** which is a powerful wordlist generator that takes a pattern, defined by placeholders, and outputs a wordlists matching the specified requirements 
	- `@` = lower case alpha characters 
	- `,` = upper case alpha characters 
	- `%` = numeric characters 
	- `^` = special characters including space 
- basic usage: `crunch <min_characters> <max_characters> -t <pattern>`
- i.e. for eight character passwords with an uppercase letter, two lowercase letters, two special characters, and three numbers: `crunch 8 8 -t ,@@^^%%%`
	- note, the password list created would be very large 
- i.e. for a 4 to 6 character length, containing only characters 0-9 and A-F, output to a file called "crunch.txt": `crunch 4 6 0123456789ABCDEF -o crunch.txt`
- you can also generate passwords based on pre-defined character-sets like those defined in `/usr/share/crunch/charset.lst` using the `-f` option followed by the path to the character set files
- i.e. `crunch 4 6 -f /usr/share/crunch/charset.lst mixalpha -o crunch.txt`
	- the `mixalpha` option includes all lower and uppercase characters 

