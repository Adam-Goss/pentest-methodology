# Discovery Methods

--- 

### Ping/NetworkSweep

With Nmap :
- usage: `nmap -sn <ip_range>`
- finding IP addresses:`nmap -sn <ip_range> -oN <file> | grep "for" | cut -d " " -f 5 > ips.txt`
	- or `nmap -v -sn <ip_range> -oG | grep "Up" | cut -d " " -f 2`
- using without ARP ping: `sudo nmap -sn <subnet> --disable-arp-ping`
- i.e. sweeping for a specific port: `nmap -p 80 10.11.1.1-254 -oG web-sweep.txt` -> `grep open web-sweep.txt | cut -d" " -f2`
	- or `nmap --top-ports=20 10.11.1.1-254 -oG top-port-sweep.txt`

With fping:
- `fping -a -g <subnet>`

With hping:
- send 3 ICMP packets: `hping3 -1 <hosts> -c 3`
- send timestamp ICMP packets (verbose output): `hping3 --icmp-ts <host> -c 3 -V`

With masscan:
- usage: `sudo masscan -p<port> <ip_range>`
- i.e. `sudo masscan -p80 10.0.0.0/8`
- i.e. `sudo masscan -p80 10.11.1.0/24 --rate=1000 -e tap0 --router-ip 10.11.0.1`

With Metasploit:
- `use post/multi/gather/ping_sweep`

<br>

### DNS Scan

With Nmap: 
- `nmap -sS -p53 <netblock>` and `nmap -sU -p53 <netblock>`

<br> 

### ARP Scan

With Nmap:
- `sudo nmap -Pn <target>`

With arp-scan:
- `sudo arp-scan -I <iface> <subnet>`

With Metasploit:
- ARP sweep: `auxiliary/scanner/discovery/arp_sweep`
- ARP scanner: `post/windows/gather/arp_scanner`







