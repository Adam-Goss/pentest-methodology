# TFTP (UDP 69)

--- 

> TFTP uses UDP port 69 and requires no authenticationâ€”clients read from, and write to servers using the datagram format outlined in RFC 1350. Due to deficiencies within the protocol (namely lack of authentication and no transport security), it is uncommon to find servers on the public Internet. Within large internal networks, however, TFTP is used to serve configuration files and ROM images to VoIP handsets and other devices

### 1) TFTP Enumeration 

TFTP doesn't provide a directory listing, so brute-force default paths with Nmap:
- `nmap -n -Pn -sU -p69 -sV --script tftp-enum <ip>`

Check if you can download/upload files:
- with Metasploit use `auxiliary/admin/tftp/tftp_transfer_util` module
- with Python:
	```python
	import tftpy
	client = tftpy.TftpClient(<ip>, <port>)
	client.download("filename in server", "/tmp/filename", timeout=5)
	client.upload("filename to upload", "/local/path/file", timeout=5)
	```
	
If you find a service installed (i.e. MSSQL), check if you can download default files from default locations like:
- `C:\SQLServer2017Media\Express_ENU\MEDIAINFO.XML`
- `C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\DATA\master.mdf`
- `C:\Program Files\Microsoft SQL Server\MSSQL14.SQLEXPRESS\MSSQL\Backup\master.mdf`
- see LFI wordlists for more examples





