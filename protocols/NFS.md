# NFS (2049)

--- 

### 1) NFS Enumeration

Enumerate the network file system:
- with nmap: `nmap -sT -sU -sV -p 2049 <ip_address>`
- with nmap NSE: `nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount <target>`
- with showmount: `showmount -e <target>`

Try to mount and access shared directory:
- `mkdir /mnt/<local>` -> `sudo mount -o nolock <ip>:/<remote_dir> /mnt<local_dir>` -> [access mount]
- or `mkdir -p /mnt/tmp` -> `mount -t nfs <nfs_server_ip>:<path/to/export/directory> /mnt/<remote_dir> -o nolock`
- i.e. `mkdir /tmp/home` -> `sudo mount -o nolock 10.11.1.72:/home /tmp/home` -> `cd /tmp/home && ls`

<br> 

### 2) NFS Exploitation

- when enumerating a the shared directory, if you come across a file which you cannot access ("permission denied"):
	- a) check the file permission on that file to find out the owner UUID (i.e. 1014)
	- b) add a local user to the Kali machine and change it's UUID to that of the file owner (i.e. 1014)
		- i.e. `sudo adduser pwn` -> `sudo sed -i -e 's/1001/1014/g' /etc/passwd` -> `cat /etc/passwd | grep pwn`
	- c) switch to that user and confirm UUID
		- i.e. `su pwn` -> `id`
	- d) then access the shared mount file from this new local account