# POP3 (110)

--- 

### 1) POP3 Enumeration

Enumerate version information:
- with nmap: `nmap -p 110 -sC -sV <target>`
- try to login to see if there is a banner: `telnet <target> 110` or `nc -nv <target> 110`

Enumerate server capabilities:
- manually: `nc -nv <target> 110` -> `CAPA`
- automatically: `nmap --script "pop3-capabilities or pop3-ntlm-info" -sV -p 110 <target>`



<br> 

### 2) POP3 Exploitation

JAMES POP3 Server 2.3.2:
> this mail server is vulnerable to RCE attacks and email enumeration 
- Email enumeration:
	- a) logged into JAMES server remote administration tool (`telent 10.11.1.72 4555`) using default credentials "root:root"
	- b) changed password for each user with `listusers` -> `setpassword <username> <new_password>`
	- c) logged into each account (`telent 10.11.1.72 110` -> `USER <username>` -> `PASS <password>` -> `LIST` -> `RETR <message_number>`) and retried emails 
- RCE exploit:
	- Metasploit modules
	- `searchsploit james server 2.3.2`



Brute force login credentials:
- `nmap -sV --script=pop3-brute <target>`

Login to server to check messages:
- `telnet <target> 110` -> `USER <username` -> `PASS <password>` -> `LIST` -> `RETR <message_number>` -> `QUIT`